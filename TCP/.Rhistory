geom_col(position = "dodge") + theme_minimal() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=0.9),
vjust=-0.5)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "NA" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=0.9),
vjust=-0.5)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=0.9),
vjust=-0.5)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=0.9),
vjust=-0.5)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=0.9),
vjust=-1)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
vjust=-1)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1.2),
vjust=-1)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=2),
vjust=-1)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
vjust=-2)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
vjust=-5)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(fct_reorder(tipo_trabalho,proportion), proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
vjust=-5)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(fct_reorder(tipo_trabalho,-proportion), proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
vjust=-5)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
vjust=-5)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1))
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
vjust=0.1)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
hjust=0.1)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
hjust=0.5)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
hjust=-0.5)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, proportion, fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
hjust=-0.25)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, round(proportion,2), fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
hjust=-0.25)
emprestimos %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, round(proportion*100,2), fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
hjust=-0.25)
emprestimos %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proportion,2)), position = position_dodge(width=1),
hjust=-0.25)
emprestimos %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,2)), position = position_dodge(width=1),
hjust=-0.25)
emprestimos %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Perfil profissional")
emprestimos %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(emprestimo == "1" ~ "Sim, e pelo menos um morador conseguiu",
emprestimo == "2" ~ "Sim, mas nenhum morador conseguiu",
emprestimo == "3" ~ "Não solicitou")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não",
plano_saude == "9" ~ "Não se aplica")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não",
plano_saude == "9" ~ "Não se aplica")) %>%
ggplot(aes(fct_reorder(tipo_trabalho,proporcao), round(proporcao,2), fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não",
plano_saude == "9" ~ "Não se aplica")) %>%
filter(plano_saude != "Não se aplica") %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não",
plano_saude == "9" ~ "Não se aplica")) %>%
filter(plano_saude != "Não se aplica") %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = emprestimo)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não",
plano_saude == "9" ~ "Não se aplica")) %>%
filter(plano_saude != "Não se aplica") %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não",
plano_saude == "9" ~ "Não se aplica")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não"))
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = ) + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "fill") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "stack") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "stack") + theme_minimal() + coord_flip() +
geom_label(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "stack") + theme_minimal() + coord_flip() +
geom_label(aes(label = round(proporcao,1), col = "white"), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "stack") + theme_minimal() + coord_flip() +
geom_label(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_label(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "dodge") + theme_minimal() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não"))
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "dodge")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = as.factor(plano_saude))) +
geom_col(position = "dodge")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = as.factor(plano_saude))) +
geom_col(position = "dodge") + theme_minimal() +  geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = as.factor(plano_saude))) +
geom_col(position = "dodge") + theme_minimal() + geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=1),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = as.factor(plano_saude))) +
geom_col(position = "dodge") + theme_minimal() + geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.5),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = as.factor(plano_saude))) +
geom_col(position = "dodge") + theme_minimal() + geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.8),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = as.factor(plano_saude))) +
geom_col(position = "dodge") + theme_minimal() + geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.9),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = (plano_saude))) +
geom_col(position = "dodge") + theme_minimal() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.9),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == "1" ~ "Sim",
plano_saude == "2" ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = as.factor(plano_saude))) +
geom_col(position = "dodge") + theme_minimal() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.9),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == 1 ~ "Sim",
plano_saude == 2 ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "dodge") + theme_minimal() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.9),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == 1 ~ "Sim",
plano_saude == 2 ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "dodge") + theme_minimal() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.9),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == 1 ~ "Sim",
plano_saude == 2 ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = as.factor(plano_saude))) +
geom_col(position = "dodge") + theme_minimal() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.9),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(emprestimo = case_when(plano_saude == 1 ~ "Sim",
plano_saude == 2 ~ "Não"))
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(plano_saude = case_when(plano_saude == 1 ~ "Sim",
plano_saude == 2 ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = as.factor(plano_saude))) +
geom_col(position = "dodge") + theme_minimal() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.9),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(plano_saude = case_when(plano_saude == 1 ~ "Sim",
plano_saude == 2 ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "dodge") + theme_minimal() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.9),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(plano_saude = case_when(plano_saude == 1 ~ "Sim",
plano_saude == 2 ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.9),
vjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
plano_saude %>%
filter(plano_saude != "9") %>%
mutate(proporcao = 100 * proportion) %>%
mutate(plano_saude = case_when(plano_saude == 1 ~ "Sim",
plano_saude == 2 ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = plano_saude)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.9),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
teste <- pnad_com_peso %>%
group_by(tipo_trabalho,teste) %>%
summarise(proportion = survey_mean(),
total = survey_total()) %>%
mutate(tipo_trabalho = case_when(tipo_trabalho == "04" ~ "Empregado",
tipo_trabalho == "06" ~ "Empregador",
tipo_trabalho == "07" ~ "Trabalhador por conta própria"))
teste_covid <- pnad_com_peso %>%
group_by(tipo_trabalho,teste) %>%
summarise(proportion = survey_mean(),
total = survey_total()) %>%
mutate(tipo_trabalho = case_when(tipo_trabalho == "04" ~ "Empregado",
tipo_trabalho == "06" ~ "Empregador",
tipo_trabalho == "07" ~ "Trabalhador por conta própria"))
View(teste_covid)
teste_covid %>%
mutate(proporcao = 100 * proportion) %>%
mutate(teste_covid = case_when(teste == 1 ~ "Sim",
teste == 2 ~ "Não")) %>%
ggplot(aes(tipo_trabalho, round(proporcao,2), fill = teste_covid)) +
geom_col(position = "dodge") + theme_minimal() + coord_flip() +
geom_text(aes(label = round(proporcao,1)), position = position_dodge(width=0.9),
hjust=-0.25) + ylab("Proporção (em %)") + xlab("Categoria profissional")
# lendo a base munic a partir do meu repositorio do Github
munic <- read.csv("https://raw.githubusercontent.com/danielppagotto/R_empreendedorismo1/main/arquivos%20de%20bases/politicas_empreendedorismo.csv",
sep = ";", encoding = "UTF-8") %>% rename(cod_cidade = X.U.FEFF.CodMun)
